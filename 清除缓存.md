# 清除打卡缓存方法

## 开发调试快速清除

### 方法一：代码中自动清除（推荐）
在 `ZhuanlemaApp.swift` 中添加：

```swift
@main
struct ZhuanlemaApp: App {
    @StateObject private var appState = AppState()
    
    init() {
        // 开发调试：每次启动清除打卡缓存
        #if DEBUG
        CheckInRepository().clearLocalCheckInCache()
        #endif
    }
    
    var body: some Scene {
        // ...
    }
}
```

### 方法二：Xcode LLDB 控制台
运行 App 后，在 Xcode 底部控制台输入：

```lldb
po UserDefaults.standard.removeObject(forKey: "lastCheckInDate")
po UserDefaults.standard.removeObject(forKey: "local_check_in_history")
```

然后重启 App（Command + R）

### 方法三：iOS 模拟器完全重置
```bash
# 关闭模拟器
killall Simulator

# 删除 App 数据
xcrun simctl uninstall booted leacent.Zhuanlema

# 重新运行
```

### 方法四：在个人中心添加清除按钮
在 `ProfileView.swift` 中添加开发者选项：

```swift
#if DEBUG
Section("开发者选项") {
    Button("清除打卡缓存") {
        CheckInRepository().clearLocalCheckInCache()
        appState.hasCheckedInToday = false
    }
    .foregroundColor(.red)
}
#endif
```

## 缓存说明

App 使用以下 UserDefaults 键存储打卡数据：

- **`lastCheckInDate`**: 最后打卡日期（格式：yyyy-MM-dd）
  - 用于判断今天是否已打卡
  - 每天只允许打卡一次

- **`local_check_in_history`**: 本地打卡历史记录（未登录时）
  - 数组格式：`[{"date": "2026-01-24", "result": "yes", "timestamp": "..."}]`
  - 登录后可以同步到云端
